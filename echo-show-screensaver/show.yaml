type: custom:button-card
variables:
  alarm_entity: sensor.bedroom_dot_next_alarm
  var_weather_entity: weather.home
  use_24_hour_time: false
entity: none
show_state: false
show_icon: false
show_name: false
triggers_update: all
tap_action: none
hold_action: none
double_tap_action: none
styles:
  card:
    - width: 1280px
    - height: 800px
    - background-image: url('/local/leaves.jpg')
    - background-size: cover
    - border-radius: 0px
    - border: none
  custom_fields:
    weather:
      - font-size: 35px
      - position: absolute
      - left: 10%
      - top: 10%
    alarm:
      - font-size: 35px
      - position: absolute
      - right: 10%
      - top: 10%
    time:
      - font-size: 175px
      - font-weight: bold
      - position: absolute
      - top: 35%
      - width: 100%
    date:
      - font-size: 60px
      - position: absolute
      - top: 65%
      - width: 100%
custom_fields:
  weather: |
    [[[
      var outdoor_temp = states[variables.var_weather_entity].attributes.temperature;
      const weatherIconsDay  = {
        "clear-night": "mdi:weather-night", 
        "cloudy": "mdi:weather-cloudy",
        "dust":"mdi:weather-dust",
        "fog": "mdi:weather-fog",
        "hail": "mdi:weather-hail",
        "hazy": "mdi:weather-hazy", 
        "hurricane": "mdi:weather-hurricane",
        "lightning": "mdi:weather-lightning",
        "lightning-rainy": "mdi:weather-lightning-rainy",
        "partlycloudy": "mdi:weather-partly-cloudy",
        "partly-lightning": "mdi:weather-partly-lightning", 
        "partly-rainy": "mdi:weather-partly-rainy",
        "partly-snowy": "mdi:weather-partly-snowy", 
        "partly-snowy-rainy": "mdi:weather-partly-snowy-rainy", 
        "pouring": "mdi:weather-pouring",
        "rainy": "mdi:weather-rainy",
        "snowy": "mdi:weather-snowy",
        "snowy-heavy": "mdi:weather-snowy-heavy",
        "snowy-rainy": "mdi:weather-snowy-rainy",
        "sunny": "mdi:weather-sunny",
        "tornado":"mdi:weather-tornado",
        "windy":  "mdi:weather-windy",
        "windy-variant": "mdi:weather-windy-variant",
      };
      const weatherIconsNight = {
        ...weatherIconsDay,
        clear: "mdi:weather-night",
        sunny: "mdi:weather-night",
        partlycloudy: "mdi:weather-night-partly-cloudy",
      };
      var condition = states[variables.var_weather_entity].state;
      if (states['sun.sun'] === 'above_horizon') {
        var weather_icon = weatherIconsDay[condition]; 
      } else {
        var weather_icon = weatherIconsNight[condition]; 
      }
      
      if (typeof(weather_icon) === 'undefined') { 
        var weather_icon = "mdi:help" 
      }   
      return `<ha-icon icon="${weather_icon}" style="width: 50px; height: 50px; color: white;"></ha-icon>
      <font color="white"><span>${outdoor_temp}Â°</span></font>`
    ]]]
  alarm: |
    [[[
      var alarm_time = new Date(states["sensor.bedroom_dot_next_alarm"].state)
      var alarm_time_formatted = (alarm_time.getHours() < 10 ? '0' : '') + alarm_time.getHours() + ":" + (alarm_time.getMinutes() < 10 ? '0' : '') + alarm_time.getMinutes() 
      return `<ha-icon icon="mdi:alarm" style="width: 50px; height: 50px; color: white;"></ha-icon>
      <font color="white"><span>${alarm_time_formatted}</span></font>`
    ]]]
  time: |
    [[[
      if (variables.use_24_hour_time) {
        var options = { hour: "2-digit", minute: "2-digit", hour12: false };
      } else {
        var options = { hour: "numeric", minute: "2-digit" };      
      }
      return new Date().toLocaleTimeString([], options).replace("AM","").replace("PM","")
    ]]]
  date: |
    [[[
      const options = { weekday: "short", month: "short", day: "numeric", };
      return new Date().toLocaleDateString([], options)
    ]]]    
